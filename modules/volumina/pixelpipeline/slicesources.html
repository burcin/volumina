

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>volumina.pixelpipeline.slicesources &mdash; volumina 0.6.0 documentation</title>
    
    <link rel="stylesheet" href="../../../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../static/doctools.js"></script>
    <link rel="top" title="volumina 0.6.0 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">volumina 0.6.0 documentation</a> &raquo;</li>
          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for volumina.pixelpipeline.slicesources</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="n">QObject</span><span class="p">,</span> <span class="n">pyqtSignal</span>
<span class="kn">from</span> <span class="nn">asyncabcs</span> <span class="kn">import</span> <span class="n">SourceABC</span><span class="p">,</span> <span class="n">RequestABC</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">volumina</span>
<span class="kn">from</span> <span class="nn">volumina.slicingtools</span> <span class="kn">import</span> <span class="n">SliceProjection</span><span class="p">,</span> <span class="n">is_pure_slicing</span><span class="p">,</span> <span class="n">intersection</span><span class="p">,</span> <span class="n">sl</span>
<span class="kn">from</span> <span class="nn">volumina.colorama</span> <span class="kn">import</span> <span class="n">Fore</span>

<span class="n">projectionAlongTXC</span> <span class="o">=</span> <span class="n">SliceProjection</span><span class="p">(</span> <span class="n">abscissa</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ordinate</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">along</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>
<span class="n">projectionAlongTYC</span> <span class="o">=</span> <span class="n">SliceProjection</span><span class="p">(</span> <span class="n">abscissa</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ordinate</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">along</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>
<span class="n">projectionAlongTZC</span> <span class="o">=</span> <span class="n">SliceProjection</span><span class="p">(</span> <span class="n">abscissa</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ordinate</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">along</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>

<span class="c">#*******************************************************************************</span>
<span class="c"># S l i c e R e q u e s t                                                      *</span>
<span class="c">#*******************************************************************************</span>

<div class="viewcode-block" id="SliceRequest"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceRequest">[docs]</a><span class="k">class</span> <span class="nc">SliceRequest</span><span class="p">(</span> <span class="nb">object</span> <span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">domainArrayRequest</span><span class="p">,</span> <span class="n">sliceProjection</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ar</span> <span class="o">=</span> <span class="n">domainArrayRequest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sp</span> <span class="o">=</span> <span class="n">sliceProjection</span>
        
<div class="viewcode-block" id="SliceRequest.wait"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceRequest.wait">[docs]</a>    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ar</span><span class="o">.</span><span class="n">wait</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="SliceRequest.getResult"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceRequest.getResult">[docs]</a>    <span class="k">def</span> <span class="nf">getResult</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ar</span><span class="o">.</span><span class="n">getResult</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="SliceRequest.notify"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceRequest.notify">[docs]</a>    <span class="k">def</span> <span class="nf">notify</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ar</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_onNotify</span><span class="p">,</span> <span class="n">package</span> <span class="o">=</span> <span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="SliceRequest.cancel"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceRequest.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ar</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="SliceRequest.submit"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceRequest.submit">[docs]</a>    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ar</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>
        </div>
<div class="viewcode-block" id="SliceRequest.adjustPriority"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceRequest.adjustPriority">[docs]</a>    <span class="k">def</span> <span class="nf">adjustPriority</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ar</span><span class="o">.</span><span class="n">adjustPriority</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="k">def</span> <span class="nf">_onNotify</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">package</span> <span class="p">):</span>
        <span class="n">callback</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">package</span>
        <span class="n">callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sp</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
<span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">SliceRequest</span><span class="p">,</span> <span class="n">RequestABC</span><span class="p">)</span>

<span class="c">#*******************************************************************************</span>
<span class="c"># S l i c e S o u r c e                                                        *</span>
<span class="c">#*******************************************************************************</span>

<div class="viewcode-block" id="SliceSource"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSource">[docs]</a><span class="k">class</span> <span class="nc">SliceSource</span><span class="p">(</span> <span class="n">QObject</span> <span class="p">):</span>
    <span class="n">areaDirty</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span> <span class="nb">object</span> <span class="p">)</span>
    <span class="n">isDirty</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span> <span class="nb">object</span> <span class="p">)</span>
    <span class="n">throughChanged</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">tuple</span> <span class="p">)</span> <span class="c"># old, new</span>
    <span class="n">idChanged</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span> <span class="nb">object</span><span class="p">,</span> <span class="nb">object</span> <span class="p">)</span> <span class="c"># old, new</span>
    
    <span class="nd">@property</span>
<div class="viewcode-block" id="SliceSource.id"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSource.id">[docs]</a>    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">))</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">through</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">)</span> <span class="c"># make a copy</span>
    <span class="nd">@through.setter</span>
<div class="viewcode-block" id="SliceSource.through"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSource.through">[docs]</a>    <span class="k">def</span> <span class="nf">through</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">along</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;SliceSource.through.setter: length of value differs from along length: </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">along</span><span class="p">))))</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">:</span>
            <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span>
            <span class="n">old_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_through</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">throughChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">old</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">old_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    </div>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datasource</span><span class="p">,</span> <span class="n">sliceProjection</span> <span class="o">=</span> <span class="n">projectionAlongTZC</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">SourceABC</span><span class="p">)</span> <span class="p">,</span> <span class="s">&#39;wrong type: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">datasource</span><span class="p">))</span> 
        <span class="nb">super</span><span class="p">(</span><span class="n">SliceSource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span> <span class="o">=</span> <span class="n">sliceProjection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datasource</span> <span class="o">=</span> <span class="n">datasource</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datasource</span><span class="o">.</span><span class="n">isDirty</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_onDatasourceDirty</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_through</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">along</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="SliceSource.setThrough"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSource.setThrough">[docs]</a>    <span class="k">def</span> <span class="nf">setThrough</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="k">assert</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">through</span><span class="p">)</span>
        <span class="n">through</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">through</span><span class="p">)</span>
        <span class="n">through</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">through</span> <span class="o">=</span> <span class="n">through</span>
</div>
<div class="viewcode-block" id="SliceSource.request"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSource.request">[docs]</a>    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">slicing2D</span><span class="p">,</span> <span class="n">along_through</span><span class="o">=</span><span class="bp">None</span> <span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Return a SliceRequest for a subregion of the slice.</span>

<span class="sd">        By default the currently set through value is used for</span>
<span class="sd">        the slicing. Optionally, some or all through values can</span>
<span class="sd">        be set to a another value (useful for requesting out-of-view</span>
<span class="sd">        slices as necessary for prefetching).</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        slicing2D    -- pair of &#39;slice&#39; objects: abscissa, ordinate</span>
<span class="sd">        along_trough -- sequence of pairs or None; </span>
<span class="sd">                        pair is &#39;(along axis, through value)&#39;</span>

<span class="sd">        Returns: a SliceRequest for a 2d array</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">slicing2D</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="c"># override through with caller values</span>
        <span class="k">if</span> <span class="n">along_through</span><span class="p">:</span>
            <span class="n">through</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">along_through</span><span class="p">:</span>
                <span class="n">through</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
           <span class="n">through</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">)</span>

        <span class="n">slicing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">domain</span><span class="p">(</span><span class="n">through</span><span class="p">,</span> <span class="n">slicing2D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">slicing2D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">volumina</span><span class="o">.</span><span class="n">verboseRequests</span><span class="p">:</span>
            <span class="n">volumina</span><span class="o">.</span><span class="n">printLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
            <span class="k">print</span> <span class="n">Fore</span><span class="o">.</span><span class="n">RED</span> <span class="o">+</span> <span class="s">&quot;SliceSource requests &#39;</span><span class="si">%r</span><span class="s">&#39; from data source &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">slicing</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datasource</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="n">Fore</span><span class="o">.</span><span class="n">RESET</span>
            <span class="n">volumina</span><span class="o">.</span><span class="n">printLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">SliceRequest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_datasource</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">slicing</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="SliceSource.setDirty"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSource.setDirty">[docs]</a>    <span class="k">def</span> <span class="nf">setDirty</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">slicing</span> <span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">slicing</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_pure_slicing</span><span class="p">(</span><span class="n">slicing</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;dirty region: slicing is not pure&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areaDirty</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span> <span class="n">slicing</span> <span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_onDatasourceDirty</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">ds_slicing</span> <span class="p">):</span>
        <span class="c"># embedding of slice in datasource space</span>
        <span class="n">embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">domain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">through</span><span class="p">)</span>
        <span class="n">inter</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="n">ds_slicing</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inter</span><span class="p">:</span> <span class="c"># there is an intersection</span>
            <span class="n">dirty_area</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
            <span class="n">dirty_area</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">inter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">abscissa</span><span class="p">]</span>
            <span class="n">dirty_area</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">inter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">ordinate</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setDirty</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirty_area</span><span class="p">))</span>

        <span class="c"># Even if no intersection with the current slice projection, mark this area</span>
        <span class="c">#  dirty in all parallel slices that may not be visible at the moment.</span>
        <span class="n">dirty_area</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="n">dirty_area</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_slicing</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">abscissa</span><span class="p">]</span>
        <span class="n">dirty_area</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_slicing</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sliceProjection</span><span class="o">.</span><span class="n">ordinate</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isDirty</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirty_area</span><span class="p">)</span> <span class="p">)</span></div>
<span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">SliceSource</span><span class="p">,</span> <span class="n">SourceABC</span><span class="p">)</span>



<span class="c">#*******************************************************************************</span>
<span class="c"># S y n c e d S l i c e S o u r c e s                                          *</span>
<span class="c">#*******************************************************************************</span>

<div class="viewcode-block" id="SyncedSliceSources"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SyncedSliceSources">[docs]</a><span class="k">class</span> <span class="nc">SyncedSliceSources</span><span class="p">(</span> <span class="n">QObject</span> <span class="p">):</span>
    <span class="n">throughChanged</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">tuple</span> <span class="p">)</span> <span class="c"># old , new</span>
    <span class="n">idChanged</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span> <span class="nb">object</span><span class="p">,</span> <span class="nb">object</span> <span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="SyncedSliceSources.id"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SyncedSliceSources.id">[docs]</a>    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">)))</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">through</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">)</span> <span class="c"># make a copy</span>
    <span class="nd">@through.setter</span>
<div class="viewcode-block" id="SyncedSliceSources.through"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SyncedSliceSources.through">[docs]</a>    <span class="k">def</span> <span class="nf">through</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;SyncedSliceSources.through.setter: length of value differs from along length: </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span><span class="p">))))</span>

        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">:</span>
            <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span>
            <span class="n">old_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_through</span> <span class="o">=</span> <span class="n">value</span>
            <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_syncSliceSource</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_srcs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">throughChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">old</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sync_along</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">initial_through</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SyncedSliceSources</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sync_along</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sync_along</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;SyncedSliceSources.__init__(): sync_along contains duplicate entries: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">sync_along</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">sync_along</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">initial_through</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_through</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_through</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">initial_through</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_through</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;SyncedSliceSources.__init__(): len(initial_through) != len(sync_along): </span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_through</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span><span class="p">))))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_through</span> <span class="o">=</span> <span class="n">initial_through</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_srcs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_srcs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_srcs</span><span class="p">)</span>

<div class="viewcode-block" id="SyncedSliceSources.getSyncAlong"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SyncedSliceSources.getSyncAlong">[docs]</a>    <span class="k">def</span> <span class="nf">getSyncAlong</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span>
</div>
<div class="viewcode-block" id="SyncedSliceSources.setThrough"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SyncedSliceSources.setThrough">[docs]</a>    <span class="k">def</span> <span class="nf">setThrough</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="p">):</span>
        <span class="k">assert</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">through</span><span class="p">)</span>
        <span class="n">through</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">through</span><span class="p">)</span>
        <span class="n">through</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">through</span> <span class="o">=</span> <span class="n">through</span>
</div>
<div class="viewcode-block" id="SyncedSliceSources.add"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SyncedSliceSources.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">sliceSrc</span> <span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">sliceSrc</span><span class="p">,</span> <span class="n">SliceSource</span> <span class="p">),</span> <span class="s">&#39;wrong type: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sliceSrc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_syncSliceSource</span><span class="p">(</span> <span class="n">sliceSrc</span> <span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_srcs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">sliceSrc</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="SyncedSliceSources.remove"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SyncedSliceSources.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">sliceSrc</span> <span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">sliceSrc</span><span class="p">,</span> <span class="n">SliceSource</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_srcs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="n">sliceSrc</span> <span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_syncSliceSource</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">sliceSrc</span> <span class="p">):</span> 
        <span class="n">through</span> <span class="o">=</span> <span class="n">sliceSrc</span><span class="o">.</span><span class="n">through</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">)):</span>
            <span class="n">through</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_along</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_through</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
        <span class="n">sliceSrc</span><span class="o">.</span><span class="n">through</span> <span class="o">=</span> <span class="n">through</span>


</div>
<span class="kn">import</span> <span class="nn">unittest</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="c">#*******************************************************************************</span>
<span class="c"># S l i c e S o u r c e T e s t                                                *</span>
<span class="c">#*******************************************************************************</span>

<div class="viewcode-block" id="SliceSourceTest"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSourceTest">[docs]</a><span class="k">class</span> <span class="nc">SliceSourceTest</span><span class="p">(</span> <span class="n">ut</span><span class="o">.</span><span class="n">TestCase</span> <span class="p">):</span>
<div class="viewcode-block" id="SliceSourceTest.setUp"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSourceTest.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
        <span class="kn">from</span> <span class="nn">datasources</span> <span class="kn">import</span> <span class="n">ArraySource</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">ArraySource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span> <span class="o">=</span> <span class="n">SliceSource</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">projectionAlongTZC</span> <span class="p">)</span>
        </div>
<div class="viewcode-block" id="SliceSourceTest.testRequest"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSourceTest.testRequest">[docs]</a>    <span class="k">def</span> <span class="nf">testRequest</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">setThrough</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">setThrough</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">setThrough</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>

        <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">request</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">)))</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">sl</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,:,</span><span class="mi">127</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>

        <span class="n">sl_bounded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">request</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)))</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">sl_bounded</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:,</span><span class="mi">127</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
</div>
<div class="viewcode-block" id="SliceSourceTest.testDirtynessPropagation"><a class="viewcode-back" href="../../../volumina.pixelpipeline.html#volumina.pixelpipeline.slicesources.SliceSourceTest.testDirtynessPropagation">[docs]</a>    <span class="k">def</span> <span class="nf">testDirtynessPropagation</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">setThrough</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">setThrough</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">setThrough</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">triggered</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">def</span> <span class="nf">check1</span><span class="p">(</span> <span class="n">dirty_area</span> <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">triggered</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">dirty_area</span><span class="p">,</span> <span class="n">sl</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">isDirty</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">check1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">setDirty</span><span class="p">(</span><span class="n">sl</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">127</span><span class="p">:</span><span class="mi">128</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">isDirty</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">check1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">triggered</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">triggered</span>

        <span class="k">def</span> <span class="nf">check2</span><span class="p">(</span> <span class="n">dirty_area</span> <span class="p">):</span>
            <span class="k">assert</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">isDirty</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">check2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">setDirty</span><span class="p">(</span><span class="n">sl</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">127</span><span class="p">:</span><span class="mi">128</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ss</span><span class="o">.</span><span class="n">isDirty</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">check2</span><span class="p">)</span>

<span class="c">#*******************************************************************************</span>
<span class="c"># i f   _ _ n a m e _ _   = =   &quot; _ _ m a i n _ _ &quot;                            *</span>
<span class="c">#*******************************************************************************</span>
</div></div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">volumina 0.6.0 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Bernhard X. Kausler, Thorben Kröger, Stuart Berg.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>